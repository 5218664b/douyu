# openwrt
## 在树莓派4b刷openwrt折腾


# Raspbian
### Raspbian Os推流
## 提供一种在树莓派4B直播推流的简单解决方案

## 已实现
- 视频无缝切换
- 使用 -c copy 不占用cpu资源
- 使用 nginx rtmp 做本地中转，方便获取流的一些信息
- 统一转换视频为.ts格式后推流，cpu占用也不大，-c copy转换很快
- 使用Danmuku获取斗鱼弹幕，收到'# XX'后调整播放的优先级

## 未实现
- 自动获取推流码
- 播放的视频列表数据通过数据库存取修改
- 添加视频进度和名字(尝试转换结果不太满意)
- 守护进程
- 后台控制

## 简单说明
### 1. 由于ffmpeg自身问题，无法循环concat模式的视频列表问题，暂时使用创建相对多的文件路径到concat文件来解决
### 2. 使用rtmp的stat获取当前推流进度，计算cache.ts的播放时间，切换到下一个视频，目前未发现问题，调整nginx的workprocess为1，否则获取的stat不准